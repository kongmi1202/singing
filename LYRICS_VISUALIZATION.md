# ðŸŽµ ê°€ì‚¬ ì‹œê°í™” ê¸°ëŠ¥

## ðŸ“‹ ê°œìš”
ë…¸ëž˜ ë¶„ì„ ê·¸ëž˜í”„ì— ê°€ì‚¬ë¥¼ **ìŒí‘œ ë§‰ëŒ€ì™€ ìˆ˜ì§ ë™ê¸°í™”**í•˜ì—¬ í‘œì‹œí•˜ëŠ” ê¸°ëŠ¥ìž…ë‹ˆë‹¤.  
í•™ìƒë“¤ì´ ë¶€ë¥´ëŠ” ìŒì´ ì–´ë–¤ ë‹¨ì–´ì™€ ì—°ê²°ë˜ëŠ”ì§€ **ì§ê´€ì ìœ¼ë¡œ ì´í•´**í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

---

## âœ¨ ì£¼ìš” íŠ¹ì§•

### 1. **ìˆ˜ì§ ë™ê¸°í™”**
- ê° ê°€ì‚¬ í…ìŠ¤íŠ¸ê°€ í•´ë‹¹ ìŒí‘œ ë§‰ëŒ€ì˜ **ì •í™•í•œ ì‹œìž‘ ì‹œê°„(Xì¢Œí‘œ)**ì— ë°°ì¹˜ë©ë‹ˆë‹¤
- ì‹œê°„ ì¶•(Xì¶•)ì„ ë”°ë¼ ê°€ì‚¬ê°€ íë¥´ë©´ì„œ í‘œì‹œë©ë‹ˆë‹¤

### 2. **ë§‰ëŒ€ ë°”ë¡œ ì•„ëž˜ ë°°ì¹˜**
- ê°€ì‚¬ëŠ” ê·¸ëž˜í”„ì˜ í•˜ë‹¨, ìŒí‘œ ë§‰ëŒ€ ë°”ë¡œ ì•„ëž˜ì— ìœ„ì¹˜í•©ë‹ˆë‹¤
- ê·¸ëž˜í”„ì™€ ì¸ì ‘í•œ ë³„ë„ ì˜ì—­ì— ëª…í™•ížˆ êµ¬ë¶„ë˜ì–´ í‘œì‹œë©ë‹ˆë‹¤

### 3. **ì‹œê°ì  ì—°ê²°**
- ê° ê°€ì‚¬ ìœ„ì¹˜ì—ì„œ ë§‰ëŒ€ê¹Œì§€ ì–‡ì€ ì—°ê²°ì„ ì´ ê·¸ë ¤ì§‘ë‹ˆë‹¤
- ì–´ë–¤ ìŒí‘œê°€ ì–´ë–¤ ê°€ì‚¬ì™€ ëŒ€ì‘ë˜ëŠ”ì§€ í•œëˆˆì— íŒŒì•… ê°€ëŠ¥í•©ë‹ˆë‹¤

---

## ðŸŽ¯ êµ¬í˜„ ë°©ì‹

### Chart.js í”ŒëŸ¬ê·¸ì¸ í™œìš©
**ìœ„ì¹˜**: `src/viz.js` (128-160ë²ˆ ì¤„)

```javascript
plugins: [{
  id: 'lyricsPlugin',
  afterDatasetsDraw: (chart) => {
    const ctx = chart.ctx
    const xScale = chart.scales.x
    const yScale = chart.scales.y
    
    // ê° ê°€ì‚¬ë¥¼ í•´ë‹¹ ìŒí‘œ ë§‰ëŒ€ ë°”ë¡œ ì•„ëž˜ì— ê·¸ë¦¬ê¸°
    lyricsInWindow.forEach(lyric => {
      const xPixel = xScale.getPixelForValue(lyric.beat)
      const yBottom = yScale.bottom + 8
      
      ctx.save()
      ctx.font = 'bold 13px sans-serif'
      ctx.fillStyle = '#333'
      ctx.textAlign = 'center'
      ctx.textBaseline = 'top'
      
      // ê°€ì‚¬ í…ìŠ¤íŠ¸ë¥¼ ìŒí‘œ ì‹œìž‘ ìœ„ì¹˜(Xì¢Œí‘œ)ì— ì •í™•ížˆ ë™ê¸°í™”
      ctx.fillText(lyric.text, xPixel, yBottom)
      
      // ì—°ê²°ì„  (ë§‰ëŒ€ì—ì„œ ê°€ì‚¬ë¡œ)
      ctx.strokeStyle = 'rgba(0,0,0,0.2)'
      ctx.lineWidth = 1
      ctx.beginPath()
      ctx.moveTo(xPixel, yScale.bottom)
      ctx.lineTo(xPixel, yBottom - 2)
      ctx.stroke()
      
      ctx.restore()
    })
  }
}]
```

---

## ðŸ“Š ì‹œê°ì  ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ìŒì • ê·¸ëž˜í”„ (Yì¶•: ìŒê³ )          â”‚
â”‚  â”â”â”â”â”“     â”â”â”â”â”“     â”â”â”â”â”“              â”‚
â”‚  â”ƒ íŒŒ â”ƒ     â”ƒ ì£¼ â”ƒ     â”ƒ ë…¹ â”ƒ  ì •ë‹µ ë§‰ëŒ€  â”‚
â”‚  â”—â”â”â”â”›     â”—â”â”â”â”›     â”—â”â”â”â”›  (íŒŒëž€ìƒ‰)   â”‚
â”‚  â”â”â”â”â”“     â”â”â”â”â”“     â”â”â”â”â”“              â”‚
â”‚  â”ƒ ì‚¬ â”ƒ     â”ƒ ë¹¨ â”ƒ     â”ƒ ë…¸ â”ƒ  ì‚¬ìš©ìž     â”‚
â”‚  â”—â”â”â”â”›     â”—â”â”â”â”›     â”—â”â”â”â”›  (ì£¼í™©ìƒ‰)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   â”‚          â”‚          â”‚                â”‚
â”‚  ë°˜         ì§         ë°˜     ê°€ì‚¬       â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€Xì¶• (ì‹œê°„/ë°•)â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸŽ“ êµìœ¡ì  íš¨ê³¼

### 1. **ìŒì•…ì  ì´í•´ í–¥ìƒ**
- ê°€ì‚¬ì™€ ìŒì •ì„ ë™ì‹œì— íŒŒì•…í•˜ì—¬ ë…¸ëž˜ì˜ ì „ì²´ êµ¬ì¡° ì´í•´
- íŠ¹ì • ë‹¨ì–´ê°€ ì–´ë–¤ ìŒë†’ì´ë¡œ ë¶ˆë ¤ì•¼ í•˜ëŠ”ì§€ ëª…í™•ížˆ ì¸ì‹

### 2. **ì¦‰ê°ì ì¸ í”¼ë“œë°±**
- í‹€ë¦° ë¶€ë¶„ì˜ ê°€ì‚¬ë¥¼ ë³´ê³  ì–´ë–¤ ë‹¨ì–´ë¥¼ ë‹¤ì‹œ ì—°ìŠµí•´ì•¼ í• ì§€ íŒŒì•…
- X í‘œì‹œì™€ ê°€ì‚¬ì˜ ì¡°í•©ìœ¼ë¡œ ë¬¸ì œ êµ¬ê°„ì„ ì •í™•ížˆ ì‹ë³„

### 3. **ì•”ê¸° ë³´ì¡°**
- ì‹œê°ì  ë™ê¸°í™”ë¡œ ë…¸ëž˜ ê°€ì‚¬ë¥¼ ë” ì‰½ê²Œ ê¸°ì–µ
- ìŒì • ë³€í™”ì™€ ê°€ì‚¬ì˜ ê´€ê³„ë¥¼ ìžì—°ìŠ¤ëŸ½ê²Œ í•™ìŠµ

---

## ðŸ“ ë ˆì´ì•„ì›ƒ ì„¤ì •

### ì—¬ë°± ì¡°ì •
```javascript
layout: { padding: { bottom: 30 } }  // ê°€ì‚¬ ê³µê°„ í™•ë³´
```

ê·¸ëž˜í”„ í•˜ë‹¨ì— 30pxì˜ íŒ¨ë”©ì„ ì¶”ê°€í•˜ì—¬ ê°€ì‚¬ê°€ í‘œì‹œë  ê³µê°„ì„ í™•ë³´í–ˆìŠµë‹ˆë‹¤.

### ê°€ì‚¬ ìœ„ì¹˜ ê³„ì‚°
```javascript
const xPixel = xScale.getPixelForValue(lyric.beat)  // ë°•(beat) â†’ í”½ì…€ ë³€í™˜
const yBottom = yScale.bottom + 8                    // ê·¸ëž˜í”„ í•˜ë‹¨ + ì—¬ë°±
```

---

## ðŸŽ¨ ìŠ¤íƒ€ì¼ë§

| ì†ì„± | ê°’ | ì„¤ëª… |
|------|-----|------|
| **í°íŠ¸** | `bold 13px sans-serif` | ëª…í™•í•œ ê°€ë…ì„± |
| **ìƒ‰ìƒ** | `#333` (ì§„í•œ íšŒìƒ‰) | ê·¸ëž˜í”„ì™€ ëŒ€ë¹„ |
| **ì •ë ¬** | `center` | ìŒí‘œ ì¤‘ì•™ ì •ë ¬ |
| **ì—°ê²°ì„ ** | `rgba(0,0,0,0.2)` | ì€ì€í•œ ì‹œê°ì  ì—°ê²° |

---

## ðŸ”„ ë°˜ì‘í˜• ë™ìž‘

### íŽ˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜
- ì™¼ìª½/ì˜¤ë¥¸ìª½ í™”ì‚´í‘œ ë²„íŠ¼ìœ¼ë¡œ 4ë§ˆë””ì”© ì´ë™ ì‹œ
- í˜„ìž¬ ë³´ì´ëŠ” ìœˆë„ìš°ì˜ ê°€ì‚¬ë§Œ ìžë™ìœ¼ë¡œ í•„í„°ë§ë˜ì–´ í‘œì‹œë©ë‹ˆë‹¤

```javascript
const lyricsInWindow = (reference.lyrics || [])
  .filter(l => l.beat >= windowStart && l.beat < windowStart + windowBeats)
```

### ìž¬ìƒ ì‹œ í•˜ì´ë¼ì´íŠ¸
- ì˜¤ë¥˜ êµ¬ê°„ í´ë¦­ ì‹œ í•´ë‹¹ ê°€ì‚¬ ì£¼ë³€ì´ ì‹œê°ì ìœ¼ë¡œ ê°•ì¡°ë©ë‹ˆë‹¤
- `highlightErrorBar` í•¨ìˆ˜ê°€ ê·¸ëž˜í”„ ì „ì²´ë¥¼ ë°ê²Œ ê¹œë¹¡ì´ëŠ” íš¨ê³¼ë¥¼ ì œê³µí•©ë‹ˆë‹¤

---

## ðŸŽµ ë°ì´í„° êµ¬ì¡°

### ê°€ì‚¬ ê°ì²´ (lyrics)
**ìœ„ì¹˜**: `src/midi.js` (12-23ë²ˆ ì¤„)

```javascript
lyrics: [
  { beat: 0, text: 'ë°˜' },
  { beat: 1, text: 'ì§' },
  { beat: 2, text: 'ë°˜' },
  { beat: 3, text: 'ì§' },
  // ...
]
```

### í•„ìˆ˜ ì†ì„±
- `beat` (number): ê°€ì‚¬ê°€ ì‹œìž‘ë˜ëŠ” ë°• ìœ„ì¹˜
- `text` (string): í‘œì‹œí•  ê°€ì‚¬ í…ìŠ¤íŠ¸

---

## ðŸ“ ì‚¬ìš© ì˜ˆì‹œ

### ê¸°ì¡´ ë…¸ëž˜ ("ìž‘ì€ ë³„")
```javascript
{
  id: 'twinkle',
  title: 'ìž‘ì€ ë³„ (4/4, C ë©”ì´ì €)',
  tempoBpm: 120,
  lyrics: [
    { beat: 0, text: 'ë°˜' },
    { beat: 1, text: 'ì§' },
    { beat: 2, text: 'ë°˜' },
    { beat: 3, text: 'ì§' },
    // ...
  ],
  notes: [
    { startBeat: 0, durationBeats: 1, midi: 60 },
    // ...
  ]
}
```

### ìƒˆë¡œìš´ ë…¸ëž˜ ì¶”ê°€ ì‹œ
1. `BUILT_IN` ë°°ì—´ì— ë…¸ëž˜ ì •ë³´ ì¶”ê°€ (`src/midi.js`)
2. `lyrics` ë°°ì—´ì— ê° ìŒí‘œì˜ ê°€ì‚¬ì™€ ì‹œìž‘ ë°• ìž…ë ¥
3. `notes` ë°°ì—´ê³¼ `lyrics` ë°°ì—´ì˜ `beat` ê°’ì´ ì •í™•ížˆ ì¼ì¹˜í•˜ë„ë¡ ì„¤ì •

---

## âœ… ê¸°ì¡´ ê¸°ëŠ¥ ìœ ì§€

ëª¨ë“  ê¸°ì¡´ ê¸°ëŠ¥ì´ ê·¸ëŒ€ë¡œ ìœ ì§€ë©ë‹ˆë‹¤:
- âœ… Xì¶•(ì‹œê°„), Yì¶•(ìŒì •) ê·¸ëž˜í”„
- âœ… ì •ë‹µ(íŒŒëž€ìƒ‰) ë§‰ëŒ€
- âœ… ì‚¬ìš©ìž(ì£¼í™©ìƒ‰) ë§‰ëŒ€
- âœ… ì˜¤ë¥˜ X í‘œì‹œ (ë¹¨ê°„ìƒ‰)
- âœ… í´ë¦­/í˜¸ë²„ ì‹œ A/B ì²­ìŒ ë¹„êµ
- âœ… íŽ˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜ (4ë§ˆë””ì”©)
- âœ… ë¶„ì„ ìš”ì•½ ë° ì ìˆ˜ í‘œì‹œ

---

## ðŸš€ í…ŒìŠ¤íŠ¸ ë°©ë²•

1. ê°œë°œ ì„œë²„ ì‹¤í–‰
```bash
npm run dev
```

2. ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì†: **http://localhost:5173**

3. "ìž‘ì€ ë³„" ì„ íƒ í›„ ë…¸ëž˜ ë…¹ìŒ ì—…ë¡œë“œ

4. ë¶„ì„ ê²°ê³¼ ê·¸ëž˜í”„ì—ì„œ ê° ìŒí‘œ ë§‰ëŒ€ ì•„ëž˜ì— ê°€ì‚¬ê°€ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

---

## ðŸŽ¯ í•µì‹¬ ê°œì„ ì‚¬í•­

### Before (ì´ì „)
- âŒ ê°€ì‚¬ê°€ ê·¸ëž˜í”„ í•˜ë‹¨ì— ë‚˜ì—´ë§Œ ë¨
- âŒ ê°€ì‚¬ì™€ ìŒí‘œì˜ ì‹œê°„ì  ì—°ê²°ì´ ë¶ˆëª…í™•
- âŒ ì–´ë–¤ ê°€ì‚¬ê°€ ì–´ëŠ ìŒí‘œì¸ì§€ íŒŒì•… ì–´ë ¤ì›€

### After (í˜„ìž¬)
- âœ… ê°€ì‚¬ê°€ ìŒí‘œ ë§‰ëŒ€ ë°”ë¡œ ì•„ëž˜ì— ë™ê¸°í™”
- âœ… Xì¶• ì‹œê°„ì— ì •í™•ížˆ ì •ë ¬
- âœ… ì—°ê²°ì„ ìœ¼ë¡œ ëª…í™•í•œ ì‹œê°ì  ëŒ€ì‘
- âœ… êµìœ¡ì  íš¨ê³¼ ê·¹ëŒ€í™”

---

## ðŸ“ž ê¸°ìˆ  ìŠ¤íƒ

- **ì‹œê°í™”**: Chart.js (í”ŒëŸ¬ê·¸ì¸ ì‹œìŠ¤í…œ)
- **ìº”ë²„ìŠ¤**: HTML5 Canvas API
- **ì¢Œí‘œ ê³„ì‚°**: Chart.js Scale API
- **ë°ì´í„° êµ¬ì¡°**: JSON (lyrics ë°°ì—´)

---

## ðŸ”§ ë³€ê²½ëœ íŒŒì¼

1. âœ… `src/viz.js` - ê°€ì‚¬ í”ŒëŸ¬ê·¸ì¸ ì¶”ê°€, lyricsRow ì œê±°
2. âœ… `LYRICS_VISUALIZATION.md` - ì´ ë¬¸ì„œ

---

**ë²„ì „**: v2.1  
**ë‚ ì§œ**: 2024ë…„  
**ìƒíƒœ**: âœ… ì ìš© ì™„ë£Œ

